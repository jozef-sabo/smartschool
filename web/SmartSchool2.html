<!DOCTYPE html>
<html lang="sk">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>SmartSchool</title>
        <link rel="stylesheet" href="SmartSchoolStyle2.css">
        <script src="https://kit.fontawesome.com/376964bc27.js" crossorigin="anonymous"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    </head>

    <body>

        <script>


          function on_page_load() {
            var data;
            // url: 'http://192.168.0.105/api/get_sensors',
            $.ajax({
              url: 'http://192.168.0.105/api/get_sensors',
              type: "GET",
              dataType: "json",
              success: function (data) {
                console.log("Success");
                //console.log(data);
                return data;
              },
              error: function () {
                console.log("Error!");
              }
            });
            return data;
          }

        </script>

        <button onclick="on_page_load()">BTN</button>

        <h1>Prízemie</h1>

        <div id=button_refresh_div>
        <button id=button_refresh onclick="update_all_room_details()"> <i class="fas fa-sync-alt"></i> </button>
        </div>
          <br>
        <div id=Prízemie><br>


        <div class="cell">

            <div class="room topLeft" style="width:10%" ></div>

            <div class="room lighter" id="room_001" onclick="openDetails()">
                <p><span class="fas fa-thermometer-half fa-xs"></span> 25°C</p>
                <p><span class="fas fa-tint fa-xs"></span> 35%</p>
                <p>CO<sub>2</sub> 500ppm </p>
            </div>

            <div class="room"></div>

            <div class="room darker" id="room_002" onclick="openDetails()">
                <p><span class="fas fa-thermometer-half fa-xs"></span> 25°C</p>
                <p><span class="fas fa-tint fa-xs"></span> 35%</p>
                <p>CO<sub>2</sub> 500ppm </p>
            </div>

            <div class="room lighter" id="room_003" onclick="openDetails()">
                <p><span class="fas fa-thermometer-half fa-xs"></span> 25°C</p>
                <p><span class="fas fa-tint fa-xs"></span> 35%</p>
                <p>CO<sub>2</sub> 500ppm </p>
            </div>

            <div class="room" style="width:15%"></div>
            <div class="chodba" style="width:10%"></div>
            <div class="room topRight" style="width:45%"></div>

        </div>



        <div class="cell">

            <div class="room "></div>
            <div class="room chodba" style="width:95%"></div>

        </div>



        <div class="cell">

            <div class="room"></div>
            <div class="room chodba"></div>
            <div style="width: 35%"></div>
            <div class="room"></div>
            <div class="room chodba"></div>
            <div style="width: 35%"></div>
            <div class="room chodba"></div>
            <div class="room"></div>

        </div>

        <div class="cell">

            <div class="room bottomLeft"></div>
            <div class="room chodba bottomRight"></div>
            <div style="width: 35%"></div>
            <div class="room"></div>
            <div class="room chodba"></div>
            <div style="width: 35%"></div>
            <div class="room chodba"></div>
            <div class="room darker" id="room_004" onclick="openDetails()">
                <p><span class="fas fa-thermometer-half fa-xs"></span> 25°C</p>
                <p><span class="fas fa-tint fa-xs"></span> 35%</p>
                <p>CO<sub>2</sub> 500ppm </p>
            </div>

        </div>
        


        <div class="cell" style="height: 20%;">

            <div style="width: 40%"></div>
            <div class="room" style="width:20%; border-radius:10px;"></div>
            <div style="width: 30%"></div>
            <div class="room chodba"></div>
            <div class="room"></div>

        </div>



        <div class="cell">

            <div style="width: 90%"></div>
            <div class="room chodba bottomLeft"></div>
            <div class="room lighter bottomRight" id="room_005" onclick="openDetails()">
                <p><span class="fas fa-thermometer-half fa-xs"></span> 25°C</p>
                <p><span class="fas fa-tint fa-xs"></span> 35%</p>
                <p>CO<sub>2</sub> 500ppm </p>
            </div>

        </div>

    </div>






    <h1>1.Poschodie</h1>
    <div id=prvePoschodie><br>



        <div class="cell">

            <div class="room topLeft" style="width:10%"></div>

            <div class="room darker" id="room_006" onclick="openDetails()">
                <p><span class="fas fa-thermometer-half fa-xs"></span> 25°C</p>
                <p><span class="fas fa-tint fa-xs"></span> 35%</p>
                <p>CO<sub>2</sub> 500ppm </p>
            </div>

            <div class="room lighter" id="room_007" onclick="openDetails()">
                <p><span class="fas fa-thermometer-half fa-xs"></span> 25°C</p>
                <p><span class="fas fa-tint fa-xs"></span> 35%</p>
                <p>CO<sub>2</sub> 500ppm </p>
            </div>

            <div class="room darker" id="room_008" onclick="openDetails()">
                <p><span class="fas fa-thermometer-half fa-xs"></span> 25°C</p>
                <p><span class="fas fa-tint fa-xs"></span> 35%</p>
                <p>CO<sub>2</sub> 500ppm </p>
            </div>

            <div class="room lighter" id="room_009" onclick="openDetails()">
                <p><span class="fas fa-thermometer-half fa-xs"></span> 25°C</p>
                <p><span class="fas fa-tint fa-xs"></span> 35%</p>
                <p>CO<sub>2</sub> 500ppm </p>
            </div>
            
            <div class="room"></div>

            <div class="room darker" id="room_010" onclick="openDetails()">
                <p><span class="fas fa-thermometer-half fa-xs"></span> 25°C</p>
                <p><span class="fas fa-tint fa-xs"></span> 35%</p>
                <p>CO<sub>2</sub> 500ppm </p>
            </div>

            <div class="room lighter" id="room_011" onclick="openDetails()">
                <p><span class="fas fa-thermometer-half fa-xs"></span> 25°C</p>
                <p><span class="fas fa-tint fa-xs"></span> 35%</p>
                <p>CO<sub>2</sub> 500ppm </p>
            </div>

            <div class="room" style="width:10%"></div>
            
            <div class="room darker" id="room_012" onclick="openDetails()">
                <p><span class="fas fa-thermometer-half fa-xs"></span> 25°C</p>
                <p><span class="fas fa-tint fa-xs"></span> 35%</p>
                <p>CO<sub>2</sub> 500ppm </p>
            </div>

            <div class="room"></div>

            <div class="room lighter" id="room_013" onclick="openDetails()">
                <p><span class="fas fa-thermometer-half fa-xs"></span> 25°C</p>
                <p><span class="fas fa-tint fa-xs"></span> 35%</p>
                <p>CO<sub>2</sub> 500ppm </p>
            </div>

            <div class="room darker" id="room_014" onclick="openDetails()">
                <p><span class="fas fa-thermometer-half fa-xs"></span> 25°C</p>
                <p><span class="fas fa-tint fa-xs"></span> 35%</p>
                <p>CO<sub>2</sub> 500ppm </p>
            </div>

            <div class="room"></div>

            <div class="room lighter" id="room_015" onclick="openDetails()">
                <p><span class="fas fa-thermometer-half fa-xs"></span> 25°C</p>
                <p><span class="fas fa-tint fa-xs"></span> 35%</p>
                <p>CO<sub>2</sub> 500ppm </p>
            </div>

            <div class="room topRight" style="width:15%"></div>

        </div>



        <div class="cell">

            <div class="room"></div>
            <div class="chodba" style="width:90%"></div>
            <div class="room"></div>

        </div>



        <div class="cell">

            <div class="room"></div>
            <div class="room chodba"></div>
            <div style="width: 35%"></div>
            <div class="room"></div>
            <div class="room chodba"></div>
            <div style="width: 35%"></div>
            <div class="room chodba"></div>
            <div class="room lighter" id="room_016" onclick="openDetails()">
                <p><span class="fas fa-thermometer-half fa-xs"></span> 25°C</p>
                <p><span class="fas fa-tint fa-xs"></span> 35%</p>
                <p>CO<sub>2</sub> 500ppm </p>
            </div>

        </div>



        <div class="cell">

            <div class="room bottomLeft"></div>
            <div class="room chodba bottomRight"></div>
            <div style="width: 35%"></div>
            <div class="room bottomLeft"></div>
            <div class="room chodba bottomRight"></div>
            <div style="width: 35%"></div>
            <div class="room chodba"></div>
            <div class="room" ></div>

        </div>



        <div class="cell">

            <div style="width: 90%"></div>
            <div class="room chodba"></div>
            <div class="room lighter" id="room_017" onclick="openDetails()">
                <p><span class="fas fa-thermometer-half fa-xs"></span> 25°C</p>
                <p><span class="fas fa-tint fa-xs"></span> 35%</p>
                <p>CO<sub>2</sub> 500ppm </p>
            </div>

        </div>



        <div class="cell">

            <div style="width: 90%"></div>
            <div class="room chodba"></div>
            <div class="room"></div>

        </div>



        <div class="cell">

            <div style="width: 90%"></div>
            <div class="room chodba bottomLeft"></div>
            <div class="room lighter bottomRight" id="room_018" onclick="openDetails()">
                <p><span class="fas fa-thermometer-half fa-xs"></span> 25°C</p>
                <p><span class="fas fa-tint fa-xs"></span> 35%</p>
                <p>CO<sub>2</sub> 500ppm </p>
            </div>

        </div>

    </div>

  
                
        <div class="modal-container" id="modal_container">
            <div class="modal">
                <h1 class=detailsWindow>Detaily o triede</h1>
                <p class=detailsWindow><span class="fas fa-thermometer-half fa-xs"></span> 25°C</p>
                <p class=detailsWindow><span class="fas fa-tint fa-xs"></span> 35%</p>
                <p class=detailsWindow>CO<sub>2</sub> 500ppm </p>
                <br>
                <button id="close">
                    Zavrieť
                </button>
                <br><br>
            </div>
        </div>
        <br><br><br><br><br>
    <script>

      // console.log("My script starting here.");
    function update_all_room_details(){

      $.ajax({
        url: 'http://192.168.0.105/api/get_sensors',
        type: "GET",
        dataType: "json",
        success: function (rooms) {
          console.log("Success");
          console.log(rooms);

          for (i=0; i<rooms.length; i++){
              console.log("Object " + i);
              console.log(rooms[i]);
              update_room_details(rooms[i]);
          }


          },
          error: function () {
            console.log("Error!");
          }
        });


    }

    function update_room_details(room_details) {

        cell_content = "";
        if ("temperature" in room_details)
        {
        cell_content += '<p><span class="fas fa-thermometer-half fa-xs"></span> '+room_details["temperature"]+'°C</p>';
        }
        if (room_details["humidity"])
        {
        cell_content += '<p><span class="fas fa-tint fa-xs"></span> '+room_details["humidity"]+'%</p>';
        }
        if (room_details["co2"])
        {
        cell_content += '<p>CO<sub>2</sub> '+room_details["co2"]+'ppm</p>';
        }
        // console.log(cell_content)

        // console.log("Room ID: ");
        // console.log(room_details["id"]);

        //detaily ako z shmu do jednej miestnosti ********
        
        document.getElementById(room_details["id"]).innerHTML = cell_content;
        }
        // Okno s detailmi
        //const open = document.getElementById('open');
        const modal_container = document.getElementById('modal_container');
        const close = document.getElementById('close');

        function openDetails(){
            modal_container.classList.add('show');
        }

          //open.addEventListener('click',()=>{
        //    modal_container.classList.add('show');
        //})

        close.addEventListener('click',()=>{
            modal_container.classList.remove('show');
        })

    </script>


    </body>
</html>
